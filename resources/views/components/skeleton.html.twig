{#
    Skeleton Loading States
    Reusable macros for displaying placeholder content while data loads
    
    Usage:
    {% import '@MyFrameworkCore/components/skeleton.html.twig' as skeleton %}
    {{ skeleton.card(3) }}
    {{ skeleton.list(5) }}
    {{ skeleton.text(2) }}
#}

{# CSS for skeleton animations #}
{% macro styles() %}
<style>
    .skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s ease-in-out infinite;
        border-radius: 4px;
    }
    
    @keyframes skeleton-loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
    }
    
    .skeleton-text {
        height: 1em;
        margin-bottom: 0.5em;
    }
    
    .skeleton-title {
        height: 1.5em;
        width: 60%;
        margin-bottom: 1em;
    }
    
    .skeleton-avatar {
        width: 48px;
        height: 48px;
        border-radius: 50%;
    }
    
    .skeleton-image {
        width: 100%;
        padding-top: 56.25%; /* 16:9 aspect ratio */
    }
</style>
{% endmacro %}

{# Single text line skeleton #}
{% macro line(width = '100%') %}
<div class="skeleton skeleton-text" style="width: {{ width }};"></div>
{% endmacro %}

{# Multiple text lines #}
{% macro text(lines = 3, lastLineWidth = '70%') %}
<div class="skeleton-text-block">
    {% for i in 1..lines %}
        {% if loop.last %}
            {{ _self.line(lastLineWidth) }}
        {% else %}
            {{ _self.line() }}
        {% endif %}
    {% endfor %}
</div>
{% endmacro %}

{# Card skeleton (e.g., for blog posts, products) #}
{% macro card(count = 1) %}
{% for i in 1..count %}
<div class="card mb-3">
    <div class="skeleton skeleton-image"></div>
    <div class="card-body">
        <div class="skeleton skeleton-title"></div>
        {{ _self.text(3) }}
    </div>
</div>
{% endfor %}
{% endmacro %}

{# List item skeleton (e.g., for comments, messages) #}
{% macro listItem() %}
<div class="d-flex align-items-start gap-3 mb-3">
    <div class="skeleton skeleton-avatar flex-shrink-0"></div>
    <div class="flex-grow-1">
        <div class="skeleton skeleton-text" style="width: 30%; margin-bottom: 0.5rem;"></div>
        {{ _self.text(2, '85%') }}
    </div>
</div>
{% endmacro %}

{# List of items #}
{% macro list(count = 5) %}
<div class="skeleton-list">
    {% for i in 1..count %}
        {{ _self.listItem() }}
    {% endfor %}
</div>
{% endmacro %}

{# Table skeleton #}
{% macro table(rows = 5, columns = 4) %}
<table class="table">
    <thead>
        <tr>
            {% for col in 1..columns %}
            <th>
                <div class="skeleton skeleton-text" style="width: 80%;"></div>
            </th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in 1..rows %}
        <tr>
            {% for col in 1..columns %}
            <td>
                <div class="skeleton skeleton-text" style="width: {{ random(60, 95) }}%;"></div>
            </td>
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endmacro %}

{# Form skeleton #}
{% macro form(fields = 3) %}
<div class="skeleton-form">
    {% for i in 1..fields %}
    <div class="mb-3">
        <div class="skeleton skeleton-text" style="width: 25%; height: 1.2em; margin-bottom: 0.5rem;"></div>
        <div class="skeleton" style="width: 100%; height: 38px;"></div>
    </div>
    {% endfor %}
    <div class="skeleton" style="width: 120px; height: 38px; margin-top: 1rem;"></div>
</div>
{% endmacro %}

{# Avatar skeleton #}
{% macro avatar(size = '48px') %}
<div class="skeleton skeleton-avatar" style="width: {{ size }}; height: {{ size }};"></div>
{% endmacro %}

{# Image skeleton #}
{% macro image(aspectRatio = '16/9') %}
{% set paddingTop = {
    '16/9': '56.25%',
    '4/3': '75%',
    '1/1': '100%',
    '21/9': '42.86%'
}[aspectRatio] ?? '56.25%' %}
<div class="skeleton skeleton-image" style="padding-top: {{ paddingTop }};"></div>
{% endmacro %}

{# Custom skeleton box #}
{% macro box(width = '100%', height = '100px') %}
<div class="skeleton" style="width: {{ width }}; height: {{ height }};"></div>
{% endmacro %}
